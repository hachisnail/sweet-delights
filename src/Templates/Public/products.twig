{% extends "Layouts/public.twig" %}

{% block content %}
<div class="p-6 flex flex-col snap-start pt-30">
  <h1 class="text-3xl font-bold text-pink-700 mb-6 text-center">Our Treats</h1>

  <!-- Category Filter -->
  {% set categories = [] %}
  {% for p in products %}
    {% if p.category not in categories %}
      {% set categories = categories|merge([p.category]) %}
    {% endif %}
  {% endfor %}

  <div class="flex flex-wrap justify-center gap-3 mb-6">
    {% for cat in categories %}
      <a href="?category={{ cat | url_encode }}" 
         class="px-4 py-2 rounded-xl border font-medium transition 
                {{ selected_category == cat 
                   ? 'bg-pink-500 text-white border-pink-500' 
                   : 'bg-white text-[#835234] hover:bg-pink-100 border-pink-300' }}">
        {{ cat }}
      </a>
    {% endfor %}

    {% if selected_category %}
      <a href="/products" class="text-sm text-gray-500 underline ml-2 self-center hover:text-pink-600">
        Clear filter
      </a>
    {% endif %}
  </div>

  <!-- Products Grid -->
  <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
    {% if products is empty %}
      <p class="text-center text-gray-500 col-span-full">No products found.</p>
    {% else %}
      {% for product in products %}
        <a href="{{ app.url }}/products/{{ product.id }}" 
           class="block bg-white p-4 rounded-2xl shadow hover:shadow-lg transition transform hover:-translate-y-1">
          <img src="{{ product.image }}" alt="{{ product.name }}" 
               class="rounded-xl mb-3 w-full h-48 object-cover">
          <h2 class="font-semibold text-lg text-[#835234] truncate">{{ product.name }}</h2>
          <p class="text-gray-500 mb-2">â‚±{{ product.price|number_format(2, '.', ',') }}</p>
          <span class="inline-block px-3 py-1 text-xs bg-pink-100 text-pink-600 rounded-full">
            {{ product.category }}
          </span>
        </a>
      {% endfor %}
    {% endif %}
  </div>
</div>


{% endblock %}
