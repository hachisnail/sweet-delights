{# FILE: Components/header.twig #}
<header class="sticky top-0 w-full px-10 py-1 bg-[#fee7b5] flex shadow-md shadow-[#cbb890] items-center z-30 flex-wrap">
  <img src="/Assets/LogoWithName.png" alt="Sweet Delights Logo" class="h-20 w-20 inline-block mr-3">

  <nav class="hidden md:flex text-[#835234] font-medium font-zen-antique h-fit gap-x-3 text-2xl">
    <a href="/" class="hover:text-[#d1a731] cursor-pointer">Home</a>
    <a href="/products" class="hover:text-[#d1a731] cursor-pointer">Products</a>
    <a href="/about" class="hover:text-[#d1a731] cursor-pointer">About Us</a>
  </nav>

  <div class="ml-auto flex gap-x-5 items-center relative">
    
    {# --- 1. DESKTOP SEARCH BAR (WITH WRAPPER) --- #}
    <div class="hidden md:flex relative mr-4">
      <form action="/search" method="GET" class="relative items-center flex">
        <label for="desktopSearch" class="sr-only">Search products or categories</label>
        <input type="search" name="q" id="desktopSearch" placeholder="Search..." autocomplete="off"
               class="rounded-full py-2 pl-10 pr-4 h-10 bg-white border border-[#cbb890] text-[#835234] placeholder:text-[#a69273] focus:outline-none focus:ring-2 focus:ring-[#A96B44]">
        <button type="submit" aria-label="Submit search" class="absolute left-3 top-1/2 -translate-y-1/2 text-[#a69273]">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </button>
      </form>
      
      {# --- NEW: Desktop search results dropdown --- #}
      <div id="desktopSearchResults" 
           class="hidden absolute top-full left-0 mt-2 w-full max-w-sm bg-white rounded-lg shadow-xl border border-pink-100 z-50">
      </div>
    </div>
    {# --- End of Desktop Search Bar --- #}

    <div class="relative flex ">
      <button id="favouriteBtn" aria-label="View favorites">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
          stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="text-[#835234] hover:text-[#d1a731] cursor-pointer">
          <path
            d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
        </svg>
      </button>
      <span id="favouriteCount"
        class="absolute -top-1 -right-2 bg-[#835234] text-white text-xs font-bold rounded-full px-1.5">0</span>
    </div>

    <div class="relative flex">
      <button id="cartBtn" aria-label="View shopping cart">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
          stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="text-[#835234] hover:text-[#d1a731] cursor-pointer">
          <circle cx="8" cy="21" r="1"/>
          <circle cx="19" cy="21" r="1"/>
          <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
        </svg>
      </button>
      <span id="cartCount"
        class="absolute -top-1 -right-2 bg-[#835234] text-white text-xs font-bold rounded-full px-1.5">0</span>
    </div>

    <div class="relative">
      <button id="userMenuBtn" aria-label="Toggle user menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
          stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="text-[#835234] hover:text-[#d1a731] cursor-pointer">
          <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
      </button>

      <div id="userDropdown" 
           class="hidden absolute top-full -right-4 mt-2 w-48 bg-white rounded-lg shadow-xl border border-pink-100 z-50 
                  
                  before:content-[''] before:absolute before:w-0 before:h-0 
                  before:border-l-[10px] before:border-l-transparent 
                  before:border-r-[10px] before:border-r-transparent 
                  before:border-b-[10px] before:border-b-white 
                  before:top-[-10px] before:right-[21px] before:z-10 
                  
                  after:content-[''] after:absolute after:w-0 after:h-0 
                  after:border-l-[11px] after:border-l-transparent 
                  after:border-r-[11px] after:border-r-transparent 
                  after:border-b-[11px] after:border-b-pink-100 
                  after:top-[-11px] after:right-5">
        
        {# 'user' variable comes from AuthMiddleware #}
        {% if user %}
          <div class="py-2">
            <div class="px-4 py-2 text-sm text-gray-500 border-b">
              Welcome, {{ user.name }}!
            </div>
            
            {% if user.role in ['admin', 'superadmin'] %}
              <a href="/app/dashboard" class="block px-4 py-2 text-gray-700 hover:bg-pink-50">Admin Panel</a>
            {% endif %}

            {# --- MODIFICATION START --- #}
            {# These links will now only show if 'onAccountPage' is not true #}
            {% if not onAccountPage %}
                <a href="/account/settings" class="block px-4 py-2 text-gray-700 hover:bg-pink-50">Account Settings</a>
                <a href="/account/orders" class="block px-4 py-2 text-gray-700 hover:bg-pink-50">My Orders</a>
            {% endif %}
            {# --- MODIFICATION END --- #}

            <a href="/logout" class="block w-full text-left px-4 py-2 text-red-600 hover:bg-pink-50 border-t">Logout</a>
          </div>
        {% else %}
          <div class="py-2">
            <a href="/login" class="block px-4 py-2 text-gray-700 hover:bg-pink-50">Login</a>
            <a href="/register" class="block px-4 py-2 text-gray-700 hover:bg-pink-50">Register</a>
          </div>
        {% endif %}

      </div>
    </div>
    
    <button id="mobileMenuBtn" class="md:hidden" aria-label="Toggle mobile menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        class="text-[#835234] hover:text-[#d1a731] cursor-pointer">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>

  </div>

  <div id="mobileMenu" class="hidden w-full md:hidden">

    <nav class="flex flex-col pt-2 pb-4 space-y-1">
      <a href="/" class="block px-3 py-2 rounded-md text-base font-medium text-[#835234] hover:bg-[#cbb890]">Home</a>
      <a href="/about" class="block px-3 py-2 rounded-md text-base font-medium text-[#835234] hover:bg-[#cbb890]">About Us</a>
      <a href="/products" class="block px-3 py-2 rounded-md text-base font-medium text-[#835234] hover:bg-[#cbb890]">Products</a>
    </nav>

        {# --- 2. MOBILE SEARCH BAR (WITH WRAPPER) --- #}
    <div class="relative p-2">
      <form action="/search" method="GET" class="relative">
        <label for="mobileSearch" class="sr-only">Search products or categories</label>
        <input type="search" name="q" id="mobileSearch" placeholder="Search..." autocomplete="off"
               class="rounded-md py-2 pl-10 pr-4 w-full h-10 bg-white border border-[#cbb890] text-[#835234] placeholder:text-[#a69273] focus:outline-none focus:ring-2 focus:ring-[#A96B44]">
        <button type="submit" aria-label="Submit search" class="absolute left-3 top-1/2 -translate-y-1/2 text-[#a69273]">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </button>
      </form>

      {# --- NEW: Mobile search results dropdown --- #}
      <div id="mobileSearchResults" 
           class="hidden absolute top-full left-0 right-0 mx-2 mt-2 bg-white rounded-lg shadow-xl border border-pink-100 z-50">
      </div>
    </div>
    {# --- End of Mobile Search Bar --- #}
  </div>

</header>