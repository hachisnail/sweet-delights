{% set activePage = 'orders' %}

{% extends "Layouts/account.twig" %}

{% block content %}
<div class="max-w-4xl mx-auto p-6 bg-white rounded-2xl shadow-lg border border-pink-100">
  <h1 class="text-3xl font-bold text-[#835234] mb-8">{{ title }}</h1>

  <div class="space-y-6">
    {% for order in orders %}
      <div class="border border-gray-200 rounded-lg p-4 shadow-sm">
        <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-2">
          
          <h2 class="text-lg font-semibold">
            <a href="/account/orders/{{ order.id }}" class="text-[#835234] hover:underline">
              Order #{{ order.id }}
            </a>
          </h2>
          
          <span class="text-sm font-medium
            {% if order.status == 'Delivered' %}text-green-600
            {% elseif order.status == 'Shipped' %}text-blue-600
            {% elseif order.status == 'Processing' %}text-yellow-600
            {% else %}text-gray-500
            {% endif %}
          ">{{ order.status }}</span>
        </div>
        <div class="text-sm text-gray-500 mb-3">
          <p>Date: {{ order.date }}</p>
          <p>Total: <span class="font-medium text-gray-700">â‚±{{ (order.total)|number_format(2) }}</span></p>
        </div>

        <!-- --- FIX: Reworked this section to show images --- -->
        <div class="text-sm text-gray-700 bg-gray-50 p-3 rounded">
          <strong class="block mb-3">Items:</strong>
          <div class="space-y-3">
            {% for item in order.items %}
              <div class="flex items-center gap-3">
                <img src="{{ item.image | default('/Assets/placeholder-item.png') }}" 
                     alt="{{ item.product_name }}" 
                     class="w-12 h-12 rounded-md object-cover border border-pink-100 bg-pink-50">
                <div>
                  <span class="font-medium text-gray-800">{{ item.product_name }}</span>
                  {% if item.size %}({{ item.size }}){% endif %}
                  <span class="text-gray-500">&times; {{ item.quantity }}</span>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
        <!-- --- END FIX --- -->

      </div>
    {% else %}
      <p class="text-gray-500">You have not placed any orders yet.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}